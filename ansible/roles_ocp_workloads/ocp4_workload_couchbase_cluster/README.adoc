= Couchbase Cluster Workload

This workload deploys a Couchbase Cluster operator on a dedicated OpenShift 4 cluster. 

== Deploy the workload
[source, bash]
----
ansible-playbook -i "${TARGET_HOST}", ./configs/ocp-workloads/ocp-workload.yml \
    -e "ansible_ssh_private_key_file=${ANSIBLE_KEY}" \
    -e "ansible_user=${ANSIBLE_USER}" \
    -e "ocp_username=${OCP_USERNAME}" \
    -e "ocp_workload=${WORKLOAD}" \
    -e "ocp4_workload_couchbase_cluster=${PROJECT}" \
    -e "num_users=${NUM_USERS}" \
    -e "guid=${GUID}" \
    -e "ACTION=create"
----

== Configuration

The workload is tested on a OCP 4.6 cluster using the OpenShift 4.6 Workshop (training) catalog instance.

According to the size of your cluster, you may need to tune the resources by making use of some of the variables from below list.

=== Variables
[source, yaml]
----
couchbase_cluster_namespace: cb-example

ocs_operator_channel: stable
ocs_source_namespace: openshift-marketplace
ocs_source: certified-operators
ocs_spec_name: couchbase-enterprise-certified
couchbase_metadata_name: couchbase-operator-subscription
----

== Delete the workload
----
ansible-playbook -i "${TARGET_HOST}", ./configs/ocp-workloads/ocp-workload.yml \
    -e "ansible_ssh_private_key_file=${ANSIBLE_KEY}" \
    -e "ansible_user=${ANSIBLE_USER}" \
    -e "ocp_username=${OCP_USERNAME}" \
    -e "ocp_workload=${WORKLOAD}" \
    -e "ocp4_workload_couchbase_cluster=${PROJECT}" \
    -e "num_users=${NUM_USERS}" \
    -e "guid=${GUID}" \
    -e "ACTION=remove"
----
